(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{494:function(s,a,n){"use strict";n.r(a);var t=n(2),e=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"mac-m1-arp-嗅探工具之-arpy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mac-m1-arp-嗅探工具之-arpy"}},[s._v("#")]),s._v(" Mac-M1 ARP 嗅探工具之 arpy")]),s._v(" "),a("br"),s._v(" "),a("h2",{attrs:{id:"_1-introduction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-introduction"}},[s._v("#")]),s._v(" 1 Introduction")]),s._v(" "),a("p",[s._v("Arpy 是一个用python编写的arp嗅探工具，他只有短短的200多行代码，通过scapy进行arp攻击，也许在实战用的用处没有太多老牌arp工具好用，但是用来学习他工作模式是一个挺好的例子,其中一个亮点就是配合Gsource可以生成内网的dns查询记录。")]),s._v(" "),a("p",[a("strong",[s._v("Function")])]),s._v(" "),a("ul",[a("li",[s._v("数据包嗅探")]),s._v(" "),a("li",[s._v("DNS查询嗅探")]),s._v(" "),a("li",[s._v("Gsource生成流量记录")])]),s._v(" "),a("p",[a("strong",[s._v("Modules")])]),s._v(" "),a("ul",[a("li",[s._v("python")]),s._v(" "),a("li",[s._v("gource")]),s._v(" "),a("li",[s._v("scapy")]),s._v(" "),a("li",[s._v("libdnet")]),s._v(" "),a("li",[s._v("libpcap")])]),s._v(" "),a("br"),s._v(" "),a("br"),s._v(" "),a("h2",{attrs:{id:"_2-约定"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-约定"}},[s._v("#")]),s._v(" 2 约定")]),s._v(" "),a("ol",[a("li",[s._v("Hardware: apple M1")]),s._v(" "),a("li",[s._v("System: macOS Montery 12.5")]),s._v(" "),a("li",[s._v("Installed:")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("- Xcode\n- homebrew\n- port\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("br"),s._v(" "),a("br"),s._v(" "),a("h2",{attrs:{id:"_3-install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-install"}},[s._v("#")]),s._v(" 3 Install")]),s._v(" "),a("ol",[a("li",[a("strong",[s._v("python")])])]),s._v(" "),a("p",[s._v("运行 arpy.py 需要在 "),a("code",[s._v("python2")]),s._v(" 环境下，否则会报错，报错内容如下:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("  File "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"arpy.py"')]),s._v(", line "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("144")]),s._v("\n    print tcpdata\n          ^\nSyntaxError: Missing parentheses "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" call to "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'print'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" Did you mean print"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("?\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("幸运的是，此错误并非不可解决。这是因为，在 "),a("code",[s._v("python3")]),s._v(" 的早期版本中，忘记在 "),a("code",[s._v("print")]),s._v(" 语句周围包含括号会引发一个错误，该错误仅显示“无效语法”。此消息不明确，因为无效语法可能是由许多问题引起的。因此，Python 引入了新的“缺少括号”错误消息主要来帮助用户。要解决此问题，请将要打印到控制台的所有值括在括号中，即 "),a("strong",[a("code",[s._v("print xxx")]),s._v(" -> "),a("code",[s._v("print(xxx)")])]),s._v(" .")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# python2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v("\nport "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" py27-pip\nport "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" pip2 pip27\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# python3")]),s._v("\nbrew "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" python@3.10\nbrew "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" pip-tools\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[a("strong",[s._v("2. "),a("a",{attrs:{href:"https://code.google.com/p/gource/",target:"_blank",rel:"noopener noreferrer"}},[s._v("gource"),a("OutboundLink")],1)])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("brew "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" boost glew sdl2_image gource\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("3. "),a("a",{attrs:{href:"https://scapy.readthedocs.io/en/latest/introduction.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("scapy"),a("OutboundLink")],1)])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Method.01: default pip2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pip install scapy")]),s._v("\npip2 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" scapy\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Method.02: pip3")]),s._v("\npip3 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" scapy\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Method.03: recommended")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/secdev/scapy.git\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" scapy\npython3 setup.py "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[a("strong",[s._v("4. libdnet")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Method.01: brew")]),s._v("\nbrew "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" libdnet\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Method.02: port")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v("\nport "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" libdnet\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[a("strong",[s._v("5. libpcap")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("brew "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" libpcap\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'export PATH=\"/opt/homebrew/opt/libpcap/bin:$PATH\"'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("~./zshrc\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/.zshrc\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("6. "),a("a",{attrs:{href:"https://github.com/ivanvza/arpy",target:"_blank",rel:"noopener noreferrer"}},[s._v("arpy"),a("OutboundLink")],1)])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Methood.01")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/ivanvza/arpy.git\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" arpy\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" arpy.py "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("目标地址"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/arpy.py\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("目标地址"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("在我们获取 arpy.py 之后，我们通过 python2 / python3 && root权限 仍然不能运行，我们会获得如下报错:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("File "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/scapy/arch/bpf/core.py"')]),s._v(", line "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("155")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" attach_filter\nraise Scapy_Exception"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Can\'t attach the BPF filter !"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nscapy.error.Scapy_Exception: Can't attach the BPF filter "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("我通过 "),a("a",{attrs:{href:"https://jonic.cn/qa/?qa=349459/python-scapy-failed-to-compile-filter-expression-macos",target:"_blank",rel:"noopener noreferrer"}},[s._v("ref1"),a("OutboundLink")],1),s._v(" && "),a("a",{attrs:{href:"https://stackoverflow.com/questions/70538069/scapy-error-scapy-exception-cant-attach-the-bpf-filter",target:"_blank",rel:"noopener noreferrer"}},[s._v("ref2"),a("OutboundLink")],1),s._v(" ,得知：")]),s._v(" "),a("ul",[a("li",[s._v("猜测是 Scapy 无法检测 en0 的链接类型来设置 802.11 过滤器，因为它将 en0 视为以太网 802.3 接口；")]),s._v(" "),a("li",[s._v("配置Scapy可选库 "),a("code",[s._v("libpcap")]),s._v(" ，运行中 "),a("code",[s._v("conf.use_pcap = True")]),s._v(";")])]),s._v(" "),a("p",[s._v("由于我并不会python，所以我只是简单的在 arpy.py 脚本中的  "),a("code",[s._v("def main()")]),s._v(" 中配置了 "),a("code",[s._v("scapy.conf.use_pcap = True")])]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" scapy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("use_pcap "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            scapy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("use_pcap "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("strong",[s._v("7. 验证")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("➜  arpy git:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("master"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ✗ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" python3 arpy.py "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.182 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.191 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" en0 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--sniff")]),s._v(" \nPassword:\nWARNING: No IPv4 address found on anpi0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nWARNING: No IPv4 address found on anpi1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nWARNING: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" No IPv4 address found on en3 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\n     _____\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  _  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("___ ___ _ _\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  _"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("__"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("__"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  _"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("_  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n    MiTM Tool "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n    v3.15 -@viljoenivan\n            \n\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Starting Sniffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Enabling IP Forwarding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Filter: "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v("src host "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".221")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".182")]),s._v(" or dst host "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".221")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".182")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")])]),s._v("\nTarget  DNS     FQDN\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Found the following "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IP layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.182 -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.255\nb"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'P\\x02}\\xcd=\\x02192.168.221.255\\x8d\\x02device_discover\\xff{"deviceId":"{\\\\"UDID\\\\":\\\\"B36EB09F62D4A7141AA9A0B133E29A211372A51D49D433375E662B963B47B7B3\\\\"}","devicename":"daochi","hicomversion":"3.1.0.0","mode":1,"deviceHash":"70086000200769327","serviceData":"","extendServiceData":"","wlanIp":"192.168.221.182","capabilityBitmap":[71],"type":14,"coapUri":"coap://192.168.221.182/device_discover"}\\x00\'')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Found the following "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IP layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.191 -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.182\nb"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'@\\x02j\\x95=\\x02192.168.221.182\\x8d\\x02device_discover\\xff{"deviceId":"{\\\\"UDID\\\\":\\\\"4FE2C31FFEA3A9F48F9FB4A12859756E949A38E1F6DCAD9AEE4B5E7052759E7F\\\\"}","devicename":"Magic3 Pro","type":14,"hicomversion":"3.2.0.0","mode":1,"deviceHash":"0","serviceData":"","wlanIp":"192.168.221.191","capabilityBitmap":[4]}\\x00\'')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Found the following "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IP layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.191 -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.182\nb"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'@\\x02j\\x95=\\x02192.168.221.182\\x8d\\x02device_discover\\xff{"deviceId":"{\\\\"UDID\\\\":\\\\"4FE2C31FFEA3A9F48F9FB4A12859756E949A38E1F6DCAD9AEE4B5E7052759E7F\\\\"}","devicename":"Magic3 Pro","type":14,"hicomversion":"3.2.0.0","mode":1,"deviceHash":"0","serviceData":"","wlanIp":"192.168.221.191","capabilityBitmap":[4]}\\x00\'')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Found the following "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IP layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.182 -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.255\nb"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'P\\x02)*=\\x02192.168.221.255\\x8d\\x02device_discover\\xff{"deviceId":"{\\\\"UDID\\\\":\\\\"B36EB09F62D4A7141AA9A0B133E29A211372A51D49D433375E662B963B47B7B3\\\\"}","devicename":"daochi","hicomversion":"3.1.0.0","mode":1,"deviceHash":"70086000200769327","serviceData":"","extendServiceData":"","wlanIp":"192.168.221.182","capabilityBitmap":[71],"type":14,"coapUri":"coap://192.168.221.182/device_discover"}\\x00\'')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Found the following "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IP layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.191 -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.182\nb"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'@\\x02I?=\\x02192.168.221.182\\x8d\\x02device_discover\\xff{"deviceId":"{\\\\"UDID\\\\":\\\\"4FE2C31FFEA3A9F48F9FB4A12859756E949A38E1F6DCAD9AEE4B5E7052759E7F\\\\"}","devicename":"Magic3 Pro","type":14,"hicomversion":"3.2.0.0","mode":1,"deviceHash":"0","serviceData":"","wlanIp":"192.168.221.191","capabilityBitmap":[4]}\\x00\'')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Found the following "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IP layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.191 -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.182\nb"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'@\\x02I?=\\x02192.168.221.182\\x8d\\x02device_discover\\xff{"deviceId":"{\\\\"UDID\\\\":\\\\"4FE2C31FFEA3A9F48F9FB4A12859756E949A38E1F6DCAD9AEE4B5E7052759E7F\\\\"}","devicename":"Magic3 Pro","type":14,"hicomversion":"3.2.0.0","mode":1,"deviceHash":"0","serviceData":"","wlanIp":"192.168.221.191","capabilityBitmap":[4]}\\x00\'')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Found the following "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IP layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.182 -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.255\nb"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'P\\x02\\xd4\\xf1=\\x02192.168.221.255\\x8d\\x02device_discover\\xff{"deviceId":"{\\\\"UDID\\\\":\\\\"B36EB09F62D4A7141AA9A0B133E29A211372A51D49D433375E662B963B47B7B3\\\\"}","devicename":"daochi","hicomversion":"3.1.0.0","mode":1,"deviceHash":"70086000200769327","serviceData":"","extendServiceData":"","wlanIp":"192.168.221.182","capabilityBitmap":[71],"type":14,"coapUri":"coap://192.168.221.182/device_discover"}\\x00\'')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Found the following "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IP layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.191 -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.182\nb"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'@\\x02\\xb2\\xfe=\\x02192.168.221.182\\x8d\\x02device_discover\\xff{"deviceId":"{\\\\"UDID\\\\":\\\\"4FE2C31FFEA3A9F48F9FB4A12859756E949A38E1F6DCAD9AEE4B5E7052759E7F\\\\"}","devicename":"Magic3 Pro","type":14,"hicomversion":"3.2.0.0","mode":1,"deviceHash":"0","serviceData":"","wlanIp":"192.168.221.191","capabilityBitmap":[4]}\\x00\'')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Found the following "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IP layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.191 -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.182\nb"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'@\\x02\\xb2\\xfe=\\x02192.168.221.182\\x8d\\x02device_discover\\xff{"deviceId":"{\\\\"UDID\\\\":\\\\"4FE2C31FFEA3A9F48F9FB4A12859756E949A38E1F6DCAD9AEE4B5E7052759E7F\\\\"}","devicename":"Magic3 Pro","type":14,"hicomversion":"3.2.0.0","mode":1,"deviceHash":"0","serviceData":"","wlanIp":"192.168.221.191","capabilityBitmap":[4]}\\x00\'')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Found the following "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IP layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.182 -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.191\nb"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'`A\\xb2\\xfe'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Found the following "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IP layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.182 -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".221.191\nb"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'`A\\xb2\\xfe'")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br")])]),a("p",[s._v("到此，就可以愉快的使用 arpy.py 来训练了。")]),s._v(" "),a("p",[s._v("当然，如果想用现成也可以，那么你可以从我fork的分支上来直接拉取代码。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("git clone https://github.com/szc3h9/arpy.git\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("br"),s._v(" "),a("br"),s._v(" "),a("h2",{attrs:{id:"usage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#usage"}},[s._v("#")]),s._v(" usage")]),s._v(" "),a("h3",{attrs:{id:"sample-commands"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sample-commands"}},[s._v("#")]),s._v(" Sample Commands")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ivanvza:~/ > sudo arpy\n     _____\n    |  _  |___ ___ _ _\n    |     |  _| . | | |\n    |__|__|_| |  _|_  |\n    MiTM Tool |_| |___|\n    v3.15 -@viljoenivan\n\nUsage: arpy -t <Target IP> -g <Gateway IP> -i <Interface>\n\nARP MiTM Tool\n\nOptions:\n  -h, --help            show this help message and exit\n  -t TARGET, --target=TARGET\n                        The Target IP\n  -g GATEWAY, --gateway=GATEWAY\n                        The Gateway\n  -i INTERFACE, --interface=INTERFACE\n                        Interface to use\n  --tcp                 Filters out only tcp traffic\n  --udp                 Filters out only udp traffic\n  -d D_PORT, --destination_port=D_PORT\n                        Filter for a destination port\n  -s S_PORT, --source_port=S_PORT\n                        Filter for a source port\n  --sniff               Sniff all passing data\n  --sniff-dns           Sniff only searched domains\n  --sniff-dns-gource    Output target's DNS searches in gource format\n  -v                    Verbose scapy packet print\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("h3",{attrs:{id:"packet-sniff"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#packet-sniff"}},[s._v("#")]),s._v(" Packet Sniff")]),s._v(" "),a("p",[s._v("This is the packet sniffer, it allows you to see your target's traffic.")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('ivanvza:~/ > sudo arpy -t 192.168.1.3 -g 192.161.1.1 -i en0 --sniff\n     _____\n    |  _  |___ ___ _ _\n    |     |  _| . | | |\n    |__|__|_| |  _|_  |\n    MiTM Tool |_| |___|\n    v3.15 -@viljoenivan\n\n\n  [Info] Starting Sniffer...\n\n[Info] Enabling IP Forwarding...\n[Info] Filter: ((src host 192.168.1.3 or dst host 192.168.1.3))\n\n[Info] Found the following (IP layer): 192.168.1.3 -> 46.101.34.90\nGET / HTTP/1.1\nUser-Agent: curl/7.37.1\nHost: ivanvza.ninja\nAccept: */*\n\n\n\n[Info] Found the following (IP layer): 46.101.34.90 -> 192.168.1.3\nHTTP/1.1 200 OK\nVary: Accept-Encoding\nContent-Type: text/html\nAccept-Ranges: bytes\nETag: "2719538271"\nLast-Modified: Thu, 30 Apr 2015 08:25:15 GMT\nContent-Length: 3213\nDate: Fri, 29 May 2015 20:15:06 GMT\nServer: Microsoft IIS\n\n<html>\n     <title>><></title>\n    <body>\n        <pre style="line-height: 1.25; white-space: pre;">\n        \\          SORRY            /\n         \\                         /\n          \\    This page does     /\n           ]   not exist yet.    [    ,\'|\n           ]                     [   /  |\n           ]___               ___[ ,\'   |\n           ]  ]\\             /[  [ |:   |\n           ]  ] \\           / [  [ |:   |\n           ]  ]  ]         [  [  [ |:   |\n           ]  ]  ]__     __[  [  [ |:   |\n           ]  ]  ] ]\\ _ /[ [  [  [ |:   |\n           ]  ]  ] ] (#) [ [  [  [ :====\'\n           ]  ]  ]_].nHn.[_[  [  [\n           ]  ]  ]  HHHHH. [  [  [\n           ]  ] /   `HH("N  \\ [  [\n           ]__]/     HHH  "  \\[__[\n           ]         NNN         [\n           ]         N/"         [\n           ]         N H         [\n          /          N            \\\n         /           q,            \\\n        /                           \\\n        </pre>\n        <h3 id="list"><h3>\n    </body>\n<script>\n\n// NOTE: window.RTCPeerConnection is "not a constructor" in FF22/23\nvar RTCPeerConnection = /*window.RTCPeerConnection ||\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br")])]),a("h3",{attrs:{id:"dns-sniff"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-sniff"}},[s._v("#")]),s._v(" DNS Sniff")]),s._v(" "),a("p",[s._v("This function allows you to see domain names that your target is currently requesting.")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ivanvza:~/ > sudo arpy -t 192.168.1.4 -g 192.168.1.1 -i en0 --sniff-dns\n     _____\n    |  _  |___ ___ _ _\n    |     |  _| . | | |\n    |__|__|_| |  _|_  |\n    MiTM Tool |_| |___|\n         - @viljoenivan\n\n\n  [Info] Starting DNS Sniffer...\n\n[Info] Enabling IP Forwarding...\n[Info] Done...\nTarget: 192.168.1.4 -> (192.168.1.1/DNS server) has searched for: www.youtube.com.\nTarget: 192.168.1.4 -> (192.168.1.1/DNS server) has searched for: s2.googleusercontent.com.\nTarget: 192.168.1.4 -> (192.168.1.1/DNS server) has searched for: google.com.\nTarget: 192.168.1.4 -> (192.168.1.1/DNS server) has searched for: s.ytimg.com.\nTarget: 192.168.1.4 -> (192.168.1.1/DNS server) has searched for: fonts.gstatic.com.\nTarget: 192.168.1.4 -> (192.168.1.1/DNS server) has searched for: yt3.ggpht.com.\nTarget: 192.168.1.4 -> (192.168.1.1/DNS server) has searched for: i.ytimg.com.\nTarget: 192.168.1.4 -> (192.168.1.1/DNS server) has searched for: safebrowsing.google.com.\nTarget: 192.168.1.4 -> (192.168.1.1/DNS server) has searched for: safebrowsing-cache.google.com.\nTarget: 192.168.1.4 -> (192.168.1.1/DNS server) has searched for: safebrowsing-cache.google.com.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h3",{attrs:{id:"dns-sniff-with-gource"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-sniff-with-gource"}},[s._v("#")]),s._v(" DNS Sniff With Gource")]),s._v(" "),a("p",[s._v("This function is more or less the same as the above, however it provides the functionality to pass it through Gource to get a live feed of what your target is viewing.")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ivanvza:~/ > sudo arpy -t 192.168.1.3 -g 192.161.1.1 -i en0 --sniff-dns-gource\n[INFO] For a live gource feed run this command in parallel with this one:\n\ntail -f /tmp/36847parsed_nmap | tee /dev/stderr | gource -log-format custom -a 1 --file-idle-time 0 -\n\n[Info] Filter: ((src host 192.168.1.3 or dst host 192.168.1.3) and dst port 53)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h4",{attrs:{id:"sample-gource-footage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sample-gource-footage"}},[s._v("#")]),s._v(" Sample Gource footage")]),s._v(" "),a("p",[a("img",{attrs:{src:"img/arpy_gource.gif",alt:""}})]),s._v(" "),a("h4",{attrs:{id:"to-do"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#to-do"}},[s._v("#")]),s._v(" To-do")]),s._v(" "),a("ul",[a("li",[s._v("Look at adding sslstrip.")]),s._v(" "),a("li",[s._v("Port it too kali.")])])])}),[],!1,null,null,null);a.default=e.exports}}]);